---
title             : "The role of cross-linguistic lexical similarity on bilingual word acquisition"
shorttitle        : "Cross-linguistic similarity and  word acquisition"

author: 
  - name          : "Gonzalo García-Castro"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Ramon Trias Fargas, 25-27, 08005 Barcelona, Spain"
    email         : "gonzalo.garciadecastro@upf.edu"
  - name          : "Daniela Avila-Varela"
    affiliation   : "1"
  - name          : "Núria Sebastian-Galles"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "Center for Brain and Cognition, Universitat Pompeu Fabra, Barcelona, Spain"

authornote: |
  Campus de Ciutadella, Universitat Pompeu Fabra, 08005, Barcelona, Spain

abstract: |
  Bilinguals face the challenging task of learning words from languages with overlapping phonologies. Floccia et al. (2018) reported larger vocabulary sizes for 24-month-old bilinguals that were learning languages that shared a greater amount of cognates (e.g., English-Dutch). The mechanisms underlying this effect remain unknown. We explore two compatible scenarios. First, we test whether cognates are learnt earlier than non-cognates. This would account for the difference in vocabulary size associated to the amount of shared cognates across languages. Second, we explore the possibility that the word-forms of one language interact with those form the other language, scaffolding the acquisition of their translation equivalents when their phonologies overlap. This mechanism, in line with the parallel activation account of bilingual speech perception, would provide a plausible explanation to why cognates are acquired ealier by bilinguals. We developed an online tool to collect parental reports of receptive and productive vocabularies from children learning Catalan and/or Spanish, and present data on receptive and productive vocabulary of bilingual toddlers aged 12 to 34 months.


  <!-- https://tinyurl.com/ybremelq -->

keywords          : "lexical acquisition, vocabulary, bilingualism"
wordcount         : "X"

bibliography      : ["../References/trajectories.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no
keep_text         : false
class             : "man"

documentclass     : "apa6"
classoption       : "man"
output            :
  papaja::apa6_pdf:
    latex_engine  : "xelatex"

  

---

```{r setup, include = FALSE}

knitr::opts_chunk$set(
    echo = FALSE,
    fig.align = "center",
    message = FALSE,
    warning = FALSE,
    cache.extra = knitr::rand_seed,
    out.width = "80%",
    results = "asis"
)
```

```{r packages, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}


# load packages
library(papaja)
library(knitr)
library(magrittr)
library(dplyr)
library(tidyr)
library(tibble)
library(ggplot2)
library(forcats)
library(readxl)
library(lubridate)
library(janitor)
library(nlme)
library(broom.mixed)
library(modelr)
library(gt)
library(data.table)
library(here)


```


```{r prepare, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

# set params
set.seed(888)
bins_interest <- c("12-14", "14-16", "16-18", "18-20", "20-22", "22-24", "24-26", "26-28", "28-30", "30-32", "32-34")
bins_expanded <- as.character(seq(1, 41, by = 2))

# import data 
dat_studies <- fread(here("Data", "00_studies.csv"), na.strings = c("", "NA")) %>%
  distinct(q_version, language, q_items)

dat_items <- read_xlsx(here("Data", "01_pool.xlsx")) %>%
    group_by() %>%
    drop_na(language) %>%
    mutate_at(vars(A, B, C, D, cognate_rater1, include, frequency), as.numeric) %>%
    mutate_at(vars(A, B, C, D, cognate_rater1, include), as.logical)

dat_participants <- fread(here("Data", "participants.csv"), na.strings = c("", "NA"))

dat_raw <- fread(here("Data", "raw.csv"), na.strings = c("", "NA")) %>%
    filter(lp %in% c("Bilingual"),
           age_bin %in% bins_interest) %>%
    as_tibble() %>%
    mutate_at(vars(date_birth, time_stamp), as_date)

dat <- fread(here("Data", "preprocessed.csv"), na.string = c("", "NA")) %>% 
    as_tibble() %>% 
    select(item, type, te, category, age_bin, item_dominance, cognate, frequency, n, successes, proportion) %>%
    mutate(age_bin = as.numeric(factor(age_bin, levels = bins_interest, ordered = TRUE))-1) %>% 
    mutate_at(vars(frequency), function(x) scale(x, center = TRUE, scale = FALSE)[,1]) %>% 
    mutate_at(vars(cognate, item_dominance), as.factor) %>% 
    arrange(type, item, te, age_bin) 

```


```{r analyses, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, cache=TRUE}

# run the analyses (see analysis.R to check to code)
# running this code chunk may take a few seconds
source(here("Code", "R", "analysis.R"), local = knitr::knit_global())

```


# Introduction


Bilingual toddlers must learn two distinct set of words (one for each language) that partially overlap in sound and meaning. Previous studies have reported that bilingual children know fewer words than their monolingual counterparts when only language is considered (e.g., English monolinguals know more words in English than English-Spanish bilinguals). When taking both languages into account, bilingual children  seem to know, at least, as many words as monolinguals do [@ben-zeev1977; @doyle1977some; @rosenblum1983word; @fernandez1992; @pearson1994; @bialystok2010; @hoff2012; @core2013; @hoff2014; @blom2019; but see @pearson1993; @houwer2014]. Not all bilinguals show a similar developmental trajectory of lexical acquisition. Recent studies have capitalised on the role of the similarity between the specific pair of languages the infant is learning. One way of measuring language similarity is by estimating the amount of cognates (i.e., form-similar translation equivalents) they share. @floccia2018 explored the impact of this form of similarity on vocabulary sizes from a large sample of 24-month-old toddlers learning English and an additional language.  Toddlers learning languages that shared a large amount of cognates (e.g., English-German) showed larger vocabulary sizes than those learning languages that shared fewer cognates (e.g., English-Spanish). @blom2019 extended these findings to children aged three to 10 years. These results suggest that the phonological overlap between the word inventories infants are acquiring impacts their trajectory of lexical acquisition.


How does cognateness influence word learning? @floccia2018 point to the possibility that parallel activation during speech perception may play a role in this cognate facilitation effect. The parallel activation principle suggests that bilinguals activate both languages in parallel during speech perception and production, even when only one of them is being used. This hypothesis can only be understood under the more general account of language non-selectivity of lexical processing, which states that translation equivalents are co-activated at the lexical level [e.g., @de1991lexical; @costa2000; @dijkstra2005; @thierry2007; @hoshino2008; @yudes2010; @bobb2020; see @kroll2013 for review]. A growing body of experimental evidence has been given shape to different formal models of bilingual lexical processing, like the Revised Hierarchical model [@kroll1994; @kroll2010], the Bilingual Interactive Activation model [BIA; @dijkstra1998bia], and its successor BIA+ [@dijkstra2002architecture], the Bilingual Language Interaction Network for Comprehension of Speech model [BLINCS; @shook2013] and, more recently, Multilink [@dijkstra2019], which represents an effort for integrating the former to account for language-non selective activation during both comprehension and production. However, these models do not address word learning during language acquisition.


It is feasible that parallel activation plays a role in vocabulary acquisition during the first years of life. On top of Floccia et al.'s findings, other studies have provided experimental evidence of parallel activation during speech perception in bilingual toddlers [@vonholzen2012; @vonholzen2019]. Yet, it is unclear how parallel activation influences word learning at these ages. What mechanisms are engaged, and how do they relate to vocabulary size? We contemplate two scenarios. First, it is possible that the reported "similarity boost" on vocabulary size is not directly related to the amount of cognates shared between both languages, but rather to the overlap across their correspondent phonological inventories. One of the measures of language similarity Floccia et al. computed is the mean phonological Levenshtein distance across translation equivalents. This involves the calculation of the number of edit operations (e.g., insertions, deletions or replacements) the phonological transcription of a word-form has to go through to become identical to that of its translation equivalent. These scores were aggregated across pairs of translation equivalents, obtaining a single similarity estimate of for each language pair. This measure embeds confounded information about the "degree of cognateness" and the amount of phonological overlap between both languages. Languages that are phonologically closer tend to share more cognates than those that are phonologically more distant (e.g., Spanish-Italian, English-Dutch), with few exceptions (e.g., Spanish-Basque). In the light of these data, it is not possible to discern whether vocabulary size is increased by the earlier acquisition of cognates or by the overlap across the phonological systems of the languages of a bilingual. We address this issue by testing two hypothesis.


## Hypothesis 1: Cognates are acquired earlier than non-cognates


First, we test whether the increase in vocabulary size reported by Floccia et al. for languages sharing a greater amount of cognates is indeed caused by cognates being acquired earlier. In line with this account, @bosch2014 found higher productive vocabulary scores in 18 month-old Catalan-Spanish bilinguals, compared to monolinguals, due to the higher presence of cognates their lexicon. We will adopt a similar approach to @braginsky2019, who modelled cross-sectional data from individual items to explore what properties were associated with an earlier acquisition. We will analyse the acquisition trajectories of a selection of `r dat_items %>% filter(include) %>% group_by(language) %>% summarise(n = n(), .groups = "drop") %>% pull(n) %>% max()` translation equivalents in a cross-section sample of Catalan/Spanish bilinguals aged 14 to 34 months of age. This approach allows to analyse how the proportion of infants that know each item changes across ages, providing a more suitable framework to put developmental hypotheses to test, instead of taking a "snapshot" of the state of the lexical of children at a single age. 


## Hypothesis 2: Cognates are acquired closer in times than non-cognates


One mechanism that could acccount for an ealier acquisition of cognates is that parallel activation makes word-forms acquired in one language available during the acquisition of word forms in the other language. One consequence of this situation is that translation equivalents scaffold the acquisition of each other. This would point to different mechanisms engaged in the acquisition of cognates vs. non-cognates. While the phonology of cognate translation equivalents overlaps, and thus could be co-activated, the phonology of non-cognates does it in a much lesser degree. Consider the case of a Catalan-Spanish bilingual toddler that has already acquired the Catalan words *porta* (/ˈpɔr.tə/, door) and *taula* (/ˈtaw.ɫə/, table), but not yet their correspondent translation equivalents in Spanish (*puerta*, /ˈpwer.ta/; *mesa* /ˈme.sa/). According to our hypothesis, hearing the word *puerta* in presence of a door should lead to the activation of *porta*, which should facilitate the acquisition of the former. On the contrary, when hearing *mesa* in presence of a table, it is unlikely that the phonology of *taula* will be activated. This mechanism should lead to cognate translation equivalents being learnt closer in time than non-cognate translation equivalents. To test this hypothesis, we will extract the age of acquisition of each word-form in the questionnaire (as estimated by the model used to test Hypothesis 1), and will calculate the difference in time between the acquisition of such word-forms and their translation equivalents. We will test how cognateness affects such outcome.


# Method


## Participants


We collected data from `r dat_raw$id_db %>% unique %>% length() %>% printnum()` bilinguals from the Metropolitan Area of Barcelona, between `r min(dat_raw$time_stamp, na.rm = TRUE) %>% format(., "%dth %B, %Y")` and `r max(dat_raw$time_stamp, na.rm = TRUE) %>% format(., "%dth %B, %Y")`. All families participated voluntarily. This study was approved by the Comitè d'Ètica de la Investigació amb Medicaments (CEIm) from Hospital del Mar (Barcelona, Spain), code XXXXXXXXX.


We assessed toddlers' language background asking parents for an estimated proportion of exposure to each language. We defined participants as Spanish- or Catalan-dominant according to the language they were exposed the most to. Participants were considered bilingual - therefore included - if exposed 50-90% of the time to the non-dominant language. We excluded participants with >10% exposure to a third language. Fig. \@ref(fig:lpdist) shows how participants were distributed across age bins and language profiles.


```{r lpdist, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

dat_participants %>%
  filter(lp %in% "Bilingual") %>% 
    mutate(bilingualism = cut_interval(bilingualism, n = 6,
                                       labels = paste0(seq(0, 50, by = 10), "%"))) %>%
    ggplot(aes(x = age_bin, y = bilingualism)) +
    stat_bin_2d(colour = "white") +
  scale_x_discrete(guide = guide_axis(n.dodge = 1)) +
    scale_fill_viridis_c(option = "plasma") +
    labs(x = "Age (months)", y = "L2 exposure", fill = "Participants") +
    theme_classic() +
    theme(axis.text = element_text(colour = "black"))
ggsave(here("Figures", "participants.png"), height = 4, width = 5)
```


## Questionnaire


Parents completed an on-line questionnaire that gathered information about their demographic status, language environment of the child, and that included two vocabulary inventories: one for Catalan and one for Spanish. We implemented the questionnaire in `formr` [@arslan2020], a free, open-source platform. Participants were randomly allocated into one of four list of items. Each list contained a distinct inventory of translation equivalents. We included items from a diverse sample of `r distinct(dat_items, category) %>% nrow()` semantic/funcional categories:  Action words, adventures, animals, body parts, clothes, color, descriptive words, food and drink, furniture and rooms, household items, on-line, outside, parts of animals, parts of things, people, pronouns, quantifiers, question words, time, toys, and vehicles. We discarded the following categories: adverbs, auxiliary words, connectives, interjections and games and routines. Those categories that did not entail more than 16 items - thus resulting in less than four items after dividing it in four lists - were not divided: all of their items were included in the four lists. Another subset of items that were part of the trial lsits of some experiments in the lab were also included in all versions.

Each item of the inventory presented a word-form, to which parents were instructed to report whether the toddlers was able to understand it, understand ans say it, or neither. The Catalan inventory contained `r filter(dat_items, language=="Catalan") %>% pull(item) %>% unique() %>% length()` items (`r filter(dat_items, cognate_rater1, language=="Catalan") %>% pull(item) %>% unique() %>% length()` cognates, `r filter(dat_items, !cognate_rater1, language=="Catalan") %>% pull(item) %>% unique() %>% length()` non-cognates) and the Spanish inventory contained `r filter(dat_items, language=="Spanish") %>% pull(item) %>% unique() %>% length()` (`r filter(dat_items, cognate_rater1, language=="Spanish") %>% pull(item) %>% unique() %>% length()` cognates, `r filter(dat_items, !cognate_rater1, language=="Spanish") %>% pull(item) %>% unique() %>% length()` non-cognates) . Items of one language were translation equivalents from the other (e.g., whenever *gos* [dog] was included in the Catalan inventory, the word *perro* was included in the Spanish inventory), roughly following a one-to-one mapping. When there were two acceptable translation equivalents for a given word, we included both (e.g., Catalan *acabar* [*to finish*] and Spanish *acabar* and *terminar*), or merged them into the same one (e.g., Spanish *mono* [*monkey*] and Catalan *mono/mico*). We excluded from the analysis multi-word items (e.g., *barrita de cereales* [cereal bar]) and items that included more than one word-form (e.g., *mono / mico*).


## Data analysis


For testing Hypothesis 1, we modelled the proportion of infants that understood or produced each item in the non-dominant language within age bins of 2 months. Our model assumes that this proportion follows a logistic curve across ages, an that the age of acquisition of each item is generated from a linear model that adjusts for the degree of exposure to the non-dominant language (*bilingualism*, 0-50%), the cognate status of the word (*cognateness*, Non-cognate vs. Cognate), and their interaction. Our prediction is that the age of acquisition will be lower for cognate words, compared to that of non-cognate words, and that this effect will be larger for more balanced bilinguals.


Items were classified into cognates and non-cognates by a trained Catalan-Spanish bilingual with broad experience in phonology and phonetics. Items were classified as L1 if the item was included in the inventory of the language the participant was dominant in, and as L2 if otherwise For instance, the item *porta* (*door*, in Catalan) was classified as L1 when answered by Catalan-dominant participants, and as L2 when answered by Spanish-dominant participants. Table \@ref(tab:itemsinfo) shows the classification of items in cognates and non-cognates and their frequency scores across the four lists of the inventories.


```{r itemsinfo, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

dat_items %>%
    drop_na(cognate_rater1) %>%
    filter(include) %>%
    select(A, B, C, D, cognate_rater1, frequency, language) %>% 
    mutate(cognate_rater1 = ifelse(cognate_rater1, "Cognate", "Non-cognate")) %>%
    pivot_longer(c(A, B, C, D), names_to = c("list"), values_to = "n") %>% 
    filter(n) %>% 
    group_by(list, language, cognate_rater1) %>% 
    summarise(n = sum(n, na.rm = TRUE),
              mean = mean(frequency, na.rm = TRUE),
              sd = sd(frequency, na.rm = TRUE),
              min = min(frequency, na.rm = TRUE),
              max = max(frequency, na.rm = TRUE),
              .groups = "drop") %>%
    ungroup() %>% 
    rename(cognateness = cognate_rater1) %>%
    relocate(list, language, cognateness, n, mean, sd, min, max) %>%
    arrange(list, language, cognateness) %>%
    mutate(list = paste("List", list)) %>% 
    pivot_wider(names_from = cognateness, values_from = c(n, mean, sd, min, max)) %>%
    clean_names() %>%
    gt(groupname_col = c("language")) %>% 
    fmt_number(columns = contains("cognate"), decimals = 2) %>%
    fmt_number(columns = starts_with("n_"), decimals = 0) %>%
    tab_header(title = md("**Questionnaire and item properties**"),
               subtitle = "Participants were randomly allocated on of the the four lists, and completed both the Catalan and the Spanish versions.") %>% 
    tab_spanner(label = "Frequency (Cognates)", columns = vars("n_cognate", "mean_cognate", "sd_cognate", "min_cognate", "max_cognate")) %>% 
    tab_spanner(label = "Frequency (Non-cognates)", columns = contains("non_cognate")) %>% 
    cols_label(list = md("**List**"), 
               n_cognate = md("*N*"),
               mean_cognate = md("*Mean*"),
               sd_cognate = md("*SD*"),
               min_cognate = md("*Min*"),
               max_cognate = md("*Max*"),
               n_non_cognate = md("*N*"),
               mean_non_cognate = md("*Mean*"),
               sd_non_cognate = md("*SD*"),
               min_non_cognate = md("*Min*"),
               max_non_cognate = md("*Max*")) 

```


We fit two separate logistic models on comprehensive and productive data, respectively. Logistic curves are characterised by three parameters[see @mahr2019 and @mahr2020 for an excellent introduction to this approach, in which we based this analysis]: (a) an *asymptote* (`asym`, upper boundary  of the proportion of infants that have acquired the item), (b) the *steepness* (`steep`, how fast the a given item is acquired by infants), and (c) a *mid-point* (`mid`, the age at which steepness is maximum). We work on the assumption that the trajectory of acquisition of items follows a logistic curve shape [@mayor2011], and that the age of acquisition of a word is fairly captured by the position of the mid-point of its curve. This approach allows us to model and estimate the age of acquisition of items explicitly. Our model estimated the asymptote and steepness as grand means across items (i.e., intercepts). Mid-points were estimated by a linear regression model that included our predictors of interest: `age`, `item_dominance` (sum-coded, L2 = -0.5, L1 = 0.5), `cognateness` (sum-coded, Non-cognate = -0.5, Cognate = 0.5). We also included random intercepts and `item dominance` slopes for each translation equivalent (`te`) [@barr2013]. Appendix 1 shows a detailed description of the model.


We estimated the parameters of our model using the Bayesian framework. Bayesian models use the Bayes rule to combine prior knowledge about the distribution of a given parameter, and the likelihood of each of the values it can take given the data. We relied on the available data on Wordbank [@frank2017] to generate our priors (see Appendix 1 for more details about our prior). In order to test the contribution of each predictor on the fit of the model, we started fitting a null model that only included an global intercept and random intercepts for each TE, then fitted a model that also included *bilingualism* and its random slopes by TE, and finally a model that also included *cognateness* and its interaction with *bilingualism*, as well as random slopes for all the fixed effects. We compared how the fit of the model changed in every step [@schad2020] using leave-one-out cross validation. We fit both the null and alternative models using the R environment [@rcoreteam2013; @rstudioteam2015] and the `brms` package [@burkner2017], which relies on the probabilistic language Stan [@carpenter2017] to approximate posterior distributions. We used Pareto-smoothed importance sampling [PSIS; @vehtari2017; @vehtari2019] to compare the null and extended models. Data and model results were processed and visualised using the `tidyverse` family of R packages [@wickham2019] and the `tidybayes` package [@kay2020].


To test Hypothesis 2, we run a Bayesian ANOVA using the difference in mid-points between the two word-forms of each translation equivalent (in Catalan and Spanish, respectively), that included *cognateness* as predictor. Using the `BayesFactor` R package [@morey2018a], we computed a Bayes factor (*BF*) that compared the likelihood of a linear model that included *cognateness* as a predictor against the likelihood of a linear model that did not, under the light of our data.


# Results


## Hypothesis 1: Are cognates acquired ealier?


#### Comprehensive data


```{r compselection, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

# compare models
selection_comp %>% 
  as.data.frame() %>% 
  clean_names() %>% 
  select(model, df, aic, bic, log_lik, l_ratio, p_value) %>% 
  mutate(p_value = printp(p_value)) %>% 
  gt() %>% 
  fmt_number(columns = 1:2, decimals = 0) %>%
  fmt_number(columns = 3:6) %>%
  fmt_missing(columns = c(6:7), missing_text = "-") %>% 
  cols_label(model = "Model",
             df = md("*df*"),
             aic = "AIC",
             bic = "BIC",
             log_lik = "Log. Likelihood",
             l_ratio = "Likelihood ratio",
             p_value = md("*p*"))

```



```{r companova, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

anova_comp %>% 
  as.data.frame() %>% 
  clean_names() %>% 
  rownames_to_column("term") %>% 
  mutate(p_value = printp(p_value)) %>% 
  gt() %>% 
  fmt_number(columns = 2, decimals = 0) %>%
  fmt_number(columns = 3:4) %>%
  cols_label(term = "Term",
             num_df = md("Num. *df*"),
             den_df = md("Den. *df*"),
             f_value = md("*F*"),
             p_value = md("*p*")) 

summary_comp <- summary(fit4_comp)

```



```{r comppredictions, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}


dat_comp %>% 
    arrange(item, age_bin, item_dominance) %>% 
    ggplot(aes(age_bin, proportion, colour = interaction(cognate, item_dominance, sep = " - "))) +
    geom_line(data = comp_preds, aes(age_bin, proportion), size = 1) + 
    stat_summary(fun = "mean", geom = "point", shape = 1, size = 3) +
    labs(x = "Age (months)", y = "Proportion", colour = "Cognateness") +
    scale_colour_brewer(palette = "Set1") +
    scale_x_continuous(breaks = unique(dat_prod$age_bin), labels = bins_interest,
                       guide = guide_axis(n.dodge = 2)) +
    theme_bw() +
    theme(text = element_text(size = 12),
          legend.position = "right",
          legend.title = element_blank(),
          axis.text = element_text(colour = "black")) +
  ggsave(here("Figures", "predictions_comp.png"))

```



### Productive data


```{r prodselection, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

# compare models
selection_prod %>% 
  as.data.frame() %>% 
  clean_names() %>% 
  select(model, df, aic, bic, log_lik, l_ratio, p_value) %>% 
  mutate(p_value = printp(p_value)) %>% 
  gt() %>% 
  fmt_number(columns = 1:2, decimals = 0) %>%
  fmt_number(columns = 3:6) %>%
  fmt_missing(columns = c(6:7), missing_text = "-") %>% 
  cols_label(model = "Model",
             df = md("*df*"),
             aic = "AIC",
             bic = "BIC",
             log_lik = "Log. Likelihood",
             l_ratio = "Likelihood ratio",
             p_value = md("*p*"))

```



```{r prodanova, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

anova_prod %>% 
  as.data.frame() %>% 
  clean_names() %>% 
  rownames_to_column("term") %>% 
  mutate(p_value = printp(p_value)) %>% 
  gt() %>% 
  fmt_number(columns = 2, decimals = 0) %>%
  fmt_number(columns = 3:4) %>%
  cols_label(term = "Term",
             num_df = md("Num. *df*"),
             den_df = md("Den. *df*"),
             f_value = md("*F*"),
             p_value = md("*p*")) 

```



```{r prodpredictions, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

dat_prod %>% 
    arrange(item, age_bin, item_dominance) %>% 
    ggplot(aes(age_bin, proportion, colour = interaction(cognate, item_dominance, sep = " - "))) +
    geom_line(data = prod_preds, aes(age_bin, proportion), size = 1) + 
    stat_summary(fun = "mean", geom = "point", shape = 1, size = 3) +
    labs(x = "Age (months)", y = "Proportion", colour = "Cognateness") +
    scale_colour_brewer(palette = "Set1") +
    scale_x_continuous(breaks = unique(dat_prod$age_bin), labels = bins_interest,
                       guide = guide_axis(n.dodge = 2)) +
    theme_bw() +
    theme(text = element_text(size = 12),
          legend.position = "right",
          legend.title = element_blank(),
          axis.text = element_text(colour = "black")) +
  ggsave(here("Figures", "predictions_prod.png"))


```



```{r ranefs, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

ggplot(rancoefs, aes(xmid_intercept, xmid_item_dominance1, colour = cognate, fill = cognate)) +
  facet_wrap(type~cognate, scales = "free") +
  geom_point(size = 3, alpha = 0.5, shape = 1, colour = "grey") +
  geom_smooth(method = "lm", formula = y~x) +
  labs(x = "Mid-point intercept", y = "Item dominance slope on Mid-point", colour = "Cognateness") +
  scale_colour_brewer(palette = "Set1") +
  scale_fill_brewer(palette = "Set1") +
  scale_x_continuous() + 
  theme_bw() +
  theme(legend.background = element_rect(fill = NA),
        legend.title = element_blank(),
        legend.key = element_rect(fill = NA),
        legend.position = "none")

```

## Hypothesis 2


```{r aoafig, echo=FALSE, message=TRUE, warning=FALSE, paged.print=FALSE}

ggplot(aoas, aes(xmid, fct_rev(item_dominance))) +
    facet_grid(cognate~type) +
    annotate(geom = "rect", xmin = 0, xmax = 10, ymin = -Inf, ymax = Inf, colour = NA, fill = "orange", alpha = 0.25)  +
    #annotate(geom = "text", x = 5, y = 0, label = "Range of observed data", size = 7) +
    geom_line(aes(group = te), colour = "black", alpha = 0.05) +
    geom_violin(fill = "grey30", colour = "grey30", width = 0.5) +
    geom_boxplot(width = 0.25, fill = "white", colour = "black", outlier.colour = NA) +
    labs(x = "Age (months)", y = "Item dominance", fill = "Item dominance", colour = "Item dominance") +
    theme_bw() +
    scale_x_continuous(breaks = -5:15, labels = bins_expanded, guide = guide_axis(n.dodge = 1)) +
    theme(legend.title = element_blank(),
          legend.position = "none",
          legend.background = element_rect(fill = NA),
          axis.text = element_text(colour = "black"),
          axis.text.x = element_text(size = 8),
          axis.title.y = element_blank(),
          panel.grid.major.y = element_blank(),
          panel.grid.minor.y = element_blank()) +
  ggsave(here("Figures", "aoa.png"))

```


# Discussion


# Appendix


## Appendix 1: Questionnaires


## Appendix 2: Model details


## Appendix 3: Session info


```{r sessioninfo, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

sessionInfo()

```




# References


\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>

\endgroup


```{r create_r-references, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

r_refs(file = "../References/trajectories.bib")

```

