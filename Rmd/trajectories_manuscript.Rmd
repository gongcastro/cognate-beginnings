---
title             : "The role of cross-linguistic lexical similarity on bilingual word acquisition"
shorttitle        : "Cross-linguistic similarity and  word acquisition"

author: 
  - name          : "Gonzalo Garcia-Castro"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Ramon Trias Fargas, 25-27, 08005 Barcelona, Spain"
    email         : "gonzalo.garciadecastro@upf.edu"
  - name          : "Daniela Avila-Varela"
    affiliation   : "1"
  - name          : "Nuria Sebastian-Galles"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "Center for Brain and Cognition, Universitat Pompeu Fabra, Barcelona, Spain"

authornote: |
  Campus de Ciutadella, Universitat Pompeu Fabra, 08005, Barcelona, Spain

abstract: |
  Bilinguals face the challenging task of learning words from languages with overlapping phonologies. Floccia et al. (2018) reported larger vocabulary sizes for 24-month-old bilinguals that were learning languages that shared a greater amount of cognates (e.g., English-Dutch). The mechanisms underlying this effect remain unknown. We explore two compatible scenarios. First, we test whether cognates are learnt earlier than non-cognates. This would account for the difference in vocabulary size associated to the amount of shared cognates across languages. Second, we explore the possibility that the word-forms of one language interact with those form the other language, scaffolding the acquisition of their translation equivalents when their phonologies overlap. This mechanism, in line with the parallel activation account of bilingual speech perception, would provide a plausible explanation to why cognates are acquired ealier by bilinguals. We developed an online tool to collect parental reports of receptive and productive vocabularies from children learning Catalan and/or Spanish, and present data on receptive and productive vocabulary of bilingual toddlers aged 12 to 34 months.


  <!-- https://tinyurl.com/ybremelq -->

keywords          : "lexical acquisition, vocabulary, bilingualism"
wordcount         : "X"

bibliography      : ["trajectories.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no
keep_text         : false
class             : "man"

documentclass     : "apa6"
classoption       : "man"
output            :
  papaja::apa6_pdf:
    latex_engine  : "xelatex"

  

---

```{r setup, include = FALSE}

knitr::opts_chunk$set(
  echo = FALSE,
  fig.align = "center",
  message = FALSE,
  warning = FALSE,
  cache.extra = knitr::rand_seed,
  out.width = "80%",
  results = "asis"
)
```

```{r packages, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

# load packages
library(papaja)
library(knitr)
library(magrittr)
library(tidyverse)
library(readxl)
library(lubridate)
library(brms)
library(tidybayes)
library(janitor)
library(gt)
library(data.table)
library(here)

source(here("R", "analyses.R"))
```

# Introduction

Learning words involves two key steps: (1) the encoding of a word form (e.g, /dɒɡ/)
and (2) its association with a referent (e.g., a DOG). There is evidence that word learning occurs at early ages: six-month-old infants show a preference toward named pictures, relative to unnamed pictures displayed side-by-side [@bergelson_at_2012]. At 7.5 months, the phonological representations of familiar words seem to be quite detailed, as infants show evidence of recognition when the whole word is uttered [@jusczyk_infants_1995], as opposed to when only part of the word is uttered. At 12 months, infants show sensitivity to both vowel and consonant mispronunciations [@mani_twelve_2010], looking shorter to named pictures when their label is mispronounced. Remarkable as it is, the phonological specificity of infants' lexical entries is only the foundation of following developmental milestones. One of them, central to this study, is the emergence of excitatory and inhibitory links between word representations, which represents one of the essential characteristics of the adult lexicon [@mcclelland_trace_1986].


Words are not learnt in isolation, but in contexts rich in word tokens and referents. The structure of toddlers' lexicon reflects this high connectivity [@wojcik_development_2018; @hills_longitudinal_2009; @fourtassi_growth_2020]. At 18 months, infants' recognition of spoken words is sensitive to phonological priming effects, suggesting that their lexical entries are phonological linked, and co-activated during speech processing [@mani_infant_2010; @mani_phonological_2011]. The emergence of semantic links in the developing lexicon occurs somewhat later, at 24 months of age, when infants show sensitivity to semantic priming  [@styles_infants_2009; @arias-trejo_what_2013; @wojcik_ontogeny_2013], and show evidence of inhibitory links between lexical-semantic entries [@chow_backward_2016; chow_vocabulary_2019]. By 24 months, toddlers' recognition of familiar words also seems to follow a hierarchical fashion, as revealed by their sensitivity to the phonology and semantic similarity of distractor pictures presented along the named picture: the interference of phonological distractors is stronger at earlier stages of spoken word recognition, that of semantic distractors is stronger at later stages [@chow_spoken_2017]. Vocabulary size predicts the emergence and the strength of these effects: 18 months-old toddlers are sensitive to semantic priming and interference too, provided they know a similar amount of words [@chow_spoken_2017; @novogrodsky_age_2020], and  the strength of the phonological and semantic distractors during spoken word recognition grows stronger along the vocabulary size of the toddlers. This suggests that the emergence of rich lexical network-- both at the phonological and the semantic levels--grows as a function of the number of words acquired by the toddler.


The structure of the lexicon also impacts the order of acquisition of new words. Words that share a high degree of phonological and/or semantic overlap with words already acquired are more likely to be acquired next [@hills_longitudinal_2009]. @borovsky_lexical_2016 and @borovsky_slowing_2020 showed that the connectivity of a given semantic category (i.e., animals) in a child's lexicon predicts a better performance in a disambiguation task, where participants are presented with a novel label in the presence of a familiar and a novel object: infants show stronger looking preference for the novel object if it belonged to a category for which many words had already been acquired. This points to the structure of the lexicon facilitating the strategies children engage during word learning.

@babineau_familiar_2020

The case of bilingual children (here defined as those learning two languages from birth) presents an opportunity to study how lexical acquisition takes placed under a more complex environment, as they  face the challenge of learning two distinct sets of words -- one for each language -- that partially overlap in sound and meaning. 

EARLY STAGES IN BILINGUAL LANGUAGE ACQUISITION


When compared to their monolingual peers, they know fewer words only when just on language is considered (e.g., English monolinguals know more words in English than English-Spanish bilinguals). When both languages are taken into account, bilingual children  seem to know, at least, as many words as monolinguals do [@leopold_study_1948; @ben-zeev_influence_1977; @doyle_some_1977; @rosenblum_word_1983; @fernandez_bilingual_1992; @umbel_measuring_1992; @pearson_patterns_1994; @bialystok_receptive_2010; @hoff_dual_2012; @core_total_2013; @hoff_expressive_2014; @blom_cross-language_2019; but see @pearson_lexical_1993; @houwer_bilingualmonolingual_2014].


@floccia_i_2018, gathered parental vocabulary estimates [@hamilton_infant_2000] from a large sample of 24-month-old toddlers learning English and an additional language (from a pool of 13 linguistically diverse languages). They computed the average phonological similarity between translation equivalents (TEs from now on; e.g.,  *table* in English and *tafel* in Dutch) for each pair of languages, and found a positive association between this measure of phonological similarity and participants' productive vocabulary sizes in their additional language. Using a similar measure of lexical similarity, @blom_cross-language_2019 extended these results to bilingual children aged three to 10, and reported a positive association between the lexical distance and comprehensive vocabulary size: bilinguals learning lexically close languages showed similar vocabulary sizes to those of monolinguals, but those learning the more distant languages showed lower vocabulary sizes.


These results suggest that linguistic distance between languages plays an important role during bilingual lexical acquisition, and that this effect operates within TEs. What mechanisms underlie this effect, and why they seem to operate differently across comprehension and production, or across the dominant and the non-dominant language, remain open issues. @floccia_i_2018 pointed to parallel activation as a candidate mechanism behind this facilitation effect. The parallel activation principle suggests that bilinguals activate lexical representations in a language non-selective way: during the comprehension or production of a word in one language (e.g., *cat*, in English) its corresponding translation in the other language is activated too [e.g., *gato*, in Spanish. There is a vast body of evidence supporting language non-selective lexical access in both adults [e.g., @dell_mediated_1991; @spivey_cross_1999; @costa_cognate_2000; @costa_lexical_2000; @dijkstra_bilingual_2005; @thierry_brain_2007; @hoshino_cognate_2008; @yudes_cognate_2010; @kroll_multilingual_2013; @singh_one_2014; @von-holzen_impact_2019; @bobb_co-activation_2020; see @costa_facilitatory_2005 for review], and children [e.g. @von-holzen_language_2012; @poulin_lexical_2013; @jardak_labels_2019; @bosma_cognate_2020]. A critical implication of parallel activation is that the word form (i.e., phonology, orthography, etc.) of both translation equivalents are available to each other, impacting the comprehension or production dynamic of any of them.


@floccia_i_2018 argue that the degree of phonological similarity between TEs (*cognateness* from now on) of both languages should lead to increased parallel activation of both languages during language exposure, facilitating the acquisition of words in both languages, and leading participants leading two lexically close languages to show larger vocabulary sizes than those learning two lexically distant languages. This account, however, neglects the fact that for parallel activation to take place and play a facilitation role, lexical representations of both pairs of the TE must have been already established in the lexicon, and their corresponding phonological forms must have been encoded. This is not the case during lexical acquisition, where at least one of the members of the pair has not being acquired yet. A more lenient definition of parallel activation could adjust to the context of lexical acquisition more easily: when only one of the members of the TE has been acquired, its lexical representation is activated when, in the presence of its referent, a phonologically similar label is uttered. Consider the case of a Catalan-Spanish bilingual that has already learned the word *gat* (Catalan for *cat*), but not *gato* (in Spanish). It is possible that, when presented with *gato* in the presence of a cat, she maps this novel label to the familiar word *gat*, and creates a lexical representation for *gato* as a synonym for *gat*. The case of a non-cognate is differing. Consider now the case of a toddler that has already learnt *gos* (Catalan for *dog*), but not *perro* (Spanish). In this case, it would not be possible to map both labels via phonology, give their lack of phonological similarity.


Under this account, cognates (i.e., phonologically similar TEs) would be acquired earlier than non-cognates, but this effect would only play a role once one of the members of the TE has been acquired. The evidence supporting an earlier age of acquisition of cognates relative to non-cognates if sparse. @schelletter_effect_2002 reported a longitudinal case-study of a German/English child who produced cognate TEs earlier than non-cognate TE. @bosch_first_2014, showed converging results from a sample of 48 monolingual and bilingual infants aged 24 months. The low number of words included in the analyses of both studies, and the lack of adjustment for lexical frequency, limits severely the strength of any conclusions concerning the difference in age of acquisition of cognates and non-cognates. On the other hand @floccia_i_2018 worked with aggregated estimates of participants' vocabulary size, losing item-level information that could provide information about change in age of acquisition of TEs associated with their degree of phonological similarity. Therefore, their results can only be considered as compatible with cognateness playing a role on age of acquisition. In this study, we aimed at overcoming these pitfalls by using unaggregated data from individual responses, testing the role of cognateness explicitly and adjusting for lexical frequency.


It also follows from the fact that cognateness operates *within* TEs that the effect of cognateness can only play a role once one of the members of the TE has been acquired, and its phonological form is available during the acquisition of its translation. Words that belong to the language of most exposure (dominant language) are likely to be acquired earlier than words in the non-dominant language [@floccia_i_2018]. @dijkstra_role_2016 tested Dutch-Frisian bilingual children aged 2.5 to four years in a comprehension task (PPVT-NL) that involved Frisian words with different degrees of phonological similarity with their Dutch TE. Infants with lower exposure to Frisian showed a better performance for words with high similarity, while no such benefit was found in children who were exposed mostly to Frisian. This suggests that infants that were mostly exposed to Dutch used the phonology of  dutch words when processing Frisian words, as revealed by a better performance for cognates than for non-cognates.
A study by @dijkstra_role_2016 showed that the degree of phonological similarity between 
the performance of  was better for cognates than for non-cognates, only for those children


Finally, previous studies have reported that the properties that describe the form of a word play a stronger role in production than comprehension than in production. This is the case of the number of phonemes [@braginsky_consistency_2019], phonological neighbourhood density [@jones_children_2019]. These results converge with @floccia_i_2018's finding that the effect of the average cognateness between languages was larger in production than in comprehension^[Although @bosch_first_2014 found that participants in their sample produced cognates earlier than non-cognates, no analyses were conducted on comprehensive data, and therefore they cannot be taken as supporting evidence for a larger effect of cognateness on production than in comprehension].  Accordingly, we expected the role of cognateness to be more central in production than in comprehension.


In summary, we investigated the effect of cognateness on the probability of acquisition of TEs, and predicted that (1) cognate TEs are acquired earlier than non-cognate TEs, that this effect will be larger in the dominant than in the non-dominant language, and larger in production than in comprehension. 

@taverna_early_2020



```{r prepare, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

participants <- read.csv(here("Data", "participants.csv"))
items <- read.csv(here("Data", "items.csv"))
vocabulary <- read.csv(here("Data", "vocabulary.csv"))
responses <- read.csv(here("Data", "responses.csv"))

```


# Method


## Participants

```{r participants, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
n_participants <- length(unique(participants$id))
dates <- as_date(range(participants$time_stamp, na.rm = TRUE))
sex <- participants %>% drop_na(sex) %>% count(sex) %>% pull(n) %>% set_names(c("female", "male"))

```

We collected data from `r printnum(n_participants)` bilinguals (`r sex[1]` female), from the Metropolitan Area of Barcelona, between `r format(dates[1], "%dth %B, %Y")` and `r format(dates[2], "%dth %B, %Y")`. All families gave informed consent before participating. This study was approved by the Comitè d'Ètica de la Investigació amb Medicaments (CEIm) from Hospital del Mar (Barcelona, Spain), code XXXXXXXXX. We assessed toddlers' language profile asking parents for an estimated proportion of exposure to each language. We excluded participants with >10% exposure to a third language. Fig. \@ref(tab:lps) illustrates the distribution of participants across language profiles and ages.


## Questionnaire

```{r items, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
pool <- multilex::pool %>% 
  drop_na(cognate)
n_categories <- distinct(pool, category) %>% nrow()
n_items <- length(unique(pool$item))
n_item_language <- count(pool, language) %>% pull(n) %>% set_names(c("catalan", "spanish"))
n_item_cognate <- count(pool, language, cognate) %>% 
  pull(n) %>% 
  set_names(c("catalan-cognate", "catalan-noncognate", "spanish-cognate", "spanish-noncognate"))
```

We implemented an on-line questionnaire using `formr` [@arslan_formr_2020], divided in three forms: a (1) language questionnaire, a (2) demographic survey, and a (3) Catalan and a Spanish vocabulary checklists. Vocabulary checklists followed a similar structure as the Oxford Communicative Developmental Inventory [@hamilton_infant_2000] and consisted in two lists of words, one in Catalan and one in Spanish). Items in one language were translation equivalents of the items in the other (e.g., whenever *gos* [dog] was included in the Catalan inventory, the word *perro* was included in the Spanish inventory), roughly following a one-to-one mapping. When there were two acceptable translation equivalents for a given word, we included both (e.g., Catalan *acabar* [*to finish*] and Spanish *acabar* and *terminar*), or merged them into the same one (e.g., Spanish *mono* [*monkey*] and Catalan *mono/mico*). We included items from a diverse sample of `r n_categories` semantic/functional categories (see Appendix 1). We discarded the following categories: adverbs, auxiliary words, connectives, interjections and games and routines. The Catalan inventory contained `r n_item_language["catalan"]` items (`r n_item_cognate["catalan-cognate"]` cognates, `r n_item_cognate["catalan-noncognate"]` non-cognates) and the Spanish inventory contained `r n_item_language["spanish"]` (`r n_item_cognate["spanish-cognate"]` cognates, `r n_item_cognate["spanish-noncognate"]` non-cognates).


For each word in the vocabulary checklists, we asked parents to report whether their child was able to understand it, understand and say it, or did not understand or say it (marked by default). Participants filled a long or a short version of the questionnaire. Participants presented with the long version filled a list of 800 translation equivalents (800 items in Catalan and 800 items in Spanish), while participants presented with a short were randomly allocated into one of four list of items. Each list contained a different set of ~400 translation equivalents (~400 in Catalan, ~400 in Spanish). Semantic/functional categories with less than 16 items--thus resulting in less than four items after dividing it in four lists--were not divided in the short version of the questionnaire: all of their items were included in the four lists. Another subset of items that were part of the trial lists of some experiments in the lab were also included in all versions. Table 2 in Appendix 1 shows the distribution of items across questionnaire versions. We excluded from the analysis multi-word items (e.g., *barrita de cereales* [cereal bar]) and items that included more than one word-form (e.g., *mono / mico*). Table \@ref(tab:itemsinfo) shows the classification of items in cognates and non-cognates and their frequency scores across the four lists of the inventories.


## Data analysis

```{r n_responses, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
n_obs <- nrow(responses)
sum_obs <- responses %>%
  group_by(te) %>%
  summarise(n = n(), .groups = "drop") %>%
  summarise(
    mean = mean(n),
    sd = sd(n),
    min = min(n),
    max = max(n)
  )

```

We gathered `r printnum(n_obs, big.mark = ",")` responses. Translation equivalents received an average of `r printnum(sum_obs$mean, digits = 2)` (*SD* = `r printnum(sum_obs$sd, digits = 2)`, *Min* = `r printnum(sum_obs$min, digits = 2)`, Max = `r printnum(sum_obs$max, digits = 2)`), both languages summed together. We modelled the probability of children understanding or producing TEs separately using logistic regression model with a binomial distribution and a logit link function. [@agresti_analysis_2010]. We included several predictors of interest to adjust this probability to participants' and items' properties of interest. These predictors are:

* Age of participant in months (`age`, $Age$) calculated as the difference in days between participants' birth date and questionnaire completion divided by 30, chunked into bins of two months width.
* Degree of bilingualism of participant (`bilingualism`, $Bilingualism$) computed as the percentage of exposure to a second language (Spanish for participants exposed to >50% to Catalan an *vice versa*), chunked into six groups of participants, with degree of bilingualism 0%, 10%, 20%, 30%, 40% and 50%)
* Lexical frequency of item (`frequency`, $Frequency$) retrieved from SUBTLEX-CAT [@boada_subtlex-cat_2019] for Catalan words and from SUBTLEX-ESP [@cuetos_subtlex-esp_2011] for Spanish words, expressed as Zipf scores [@zipf_human_1949; @heuven_subtlex-uk_2014], and centred around the mean
* Language the item belongs to (`dominance`, $Dominance$) labelled as `L1` if the item belongs to the dominant language (e.g., a Catalan item is labelled as `L1` for Catalan-dominant participants and as `L2` for Spanish-dominant participants)
* Cognateness of the item (`cognate`, $Cognate$), as rated by a trained Spanish-Catalan bilingual linguist.

We aggregated the data across participants. We summed the number of participants that *understood*, or *understood and produced* each TE for each combination of the `age`, `bilingualism` levels. Numerical variables (`age`, `bilingualism`, and `frequency`) were standardized, and categorical predictors were sum-coded. `dominance` was coded as `L2` = -0.5 and `L1` = +0.5, and `cognate` was coded as `Non-cognate` = -0.5 and `Cognate` = +0.5. In summary, each TE provided four data points per age bin: L1-Cognate, L1-Non-cognate, L2-Cognate, and L2-Non-cognate.

We adopted a Bayesian approach toward statistical inference. This approach allows to (1) incorporate previous domain knowledge into the inference process implementing the Bayes theorem, and (2) to quantify the uncertainty associated to the estimated parameters in our model [@mcelreath_statistical_2016]. We first fit a base model that only adjusted for the age of participants and the lexical frequency of the items [@braginsky_consistency_2016: @jones_children_2018]. We then introduced our predictors of interest in the following order: (1) `dominance`, (2) `bilingualism`, (3) `dominance` per `bilingualism` interaction, (4) `cognate`, (5) `dominance` per `cognate` interaction, (6) `bilingualism` per `cognate` interaction, and (7) `dominance` per `bilingualism` per `cognate` interaction. Our extended model can be formalised as follows:


$$
\begin{aligned}
y_i \sim Binomial(n_i, p_i), \\
logit(p_i) &=& \alpha - \dots \\
& \beta_1 \times Age_i + \dots \\
& \beta_2 \times Frequency_i + \dots \\
& \beta_3 \times Dominance_i + \dots \\
& \beta_4 \times Bilingualism_i + \dots \\
& \beta_5 \times Cognate_i + \dots \\
& \beta_6 \times (Dominance_i \times Bilingualism_i) + \dots \\
& \beta_7 \times (Dominance_i \times Cognate_i) + \dots \\
& \beta_8 \times (Bilingualism_i \times Cognate_i) + \dots \\
& \beta_9 \times (Dominance_i \times Bilingualism_i \times Cognate_i), \\
logit(p_i) = log\frac{y_i}{n_i-y_i} \\
\alpha \sim Normal(0, 1.5) \\
\beta_{0-9} \sim Normal(0, 0.5)
\end{aligned}
$$

Where:

* $y_i$ is the sum of positive responses to *Understands* or *Understands and Says* for translation equivalent $i$
* $n_i$ is the total number of responses for translation equivalent $i$
* $\alpha$ is the intercept, which corresponds to the probability of a positive response when all predictors equal 0
* $\beta_{1, \dots, 9}$ are the coefficients of the predictors

We implemented this model using the R package `brms` [@R-brms_b; carpenter_stan_2017] as `response ~  age + frequency + dominance*bilingualism*cognate`, running four MCMC sampling chains with 1,000 iterations each, including 500 warm-up iterations per chain. Appendix 2 shows different diagnostics of chain convergence. We compared all models using leave-one-out cross-validation (LOO-CV) [@vehtari_practical_2017]^[Due to the high computational cost associated with a large dataset, we used a sub-sampling approach for performing Bayesian LOO with 1,000 samples [@magnusson_leave_2019]]. This method computes, for a given model, the sum of the log scores of the posterior predictive distributions that result from removing one data-point at a time, providing an estimate of the model fit. The LOO estimates are adjusted for the number of parameters estimated in the model, therefore accounting for overfitting. We compared the expected log posterior density of each each model to test which one fitted the data the best.

We then explored the posterior distribution of each parameter in the model that fitted the data the best computing the 95% credible intervals and testing whether this interval excluded 0. Credible intervals (CrI) indicate the range of values we are 95% certain contain the true value of the parameter, given our prior and observed data. We performed follow-up tests on interactions whose 95% credible interval excluded 0 by comparing the 95% credible interval of their estimated marginal means using the `emmeans` package [@R-emmeans]. Data processing and visualisation was done in R [@R-base] using the `tidyverse` family of packages [@R-tidyverse], and posterior samples were extracted using the `tidybayes` R package [@R-tidybayes].

# Results

```{r results, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
load(here("Results", "comp_fits.RData"))
load(here("Results", "prod_fits.RData"))
load(here("Results", "loos.RData"))

coef_comp <- as.data.frame(fixef(comp_7))
```


## Comprehension

The extended model, including the three-way interaction `dominance1:bilingualism;cognate1` fitted comprehension data the best: it showed the smallest absolute expected log predictive density. This estimate is several times larger than its standard error indicating high predictive accuracy. Table 2 summarises the LOO scores of the fitted models.

```{r loos, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
loos_diff <- bind_rows(
  "Comprehension" = select(
    as.data.frame(loos_comp$diffs),
    one_of("elpd_loo", "se_elpd_loo", "p_loo", "elpd_diff", "se_diff")
  ),
  "Production" = select(
    as.data.frame(loos_prod$diffs),
    one_of("elpd_loo", "se_elpd_loo", "p_loo", "elpd_diff", "se_diff")
  ),
  .id = "type"
) %>% 
  mutate(
    model = rep(rev(c(
      "~ 1 + age + frequency",
      "... + dominance",
      "... + bilingualism",
      "... + dominance:bilingualism",
      "... + cognate",
      "... + dominance:cognate",
      "... + bilingualism:cognate",
      "... + dominance:bilingualism:cognate"
    )), 2)) %>% 
  relocate(model) %>% 
  group_by(type) %>% 
  arrange(elpd_loo)

gt(loos_diff) %>% 
  tab_spanner(
    label = md("**Comparison**"),
    columns = c("elpd_diff", "se_diff")
  ) %>% 
  cols_label(
    model = md("**Model**"),
    elpd_loo = md("**ELPD**"),
    se_elpd_loo = md("**SE**"),
    p_loo = md("**p**"),
    elpd_diff = md("*LOO<sub>diff</sup>*"),
    se_diff = md("*SE<sub>diff</sup>*")
  ) %>% 
  fmt_number(2:5) %>% 
  tab_footnote(
    footnote = md("*ELPD*: theoretical expected log pointwise predictive density for a new dataset, as estimated using Bayesian LOO-CV"),
    locations = cells_column_labels(columns = vars("elpd_loo"))
  ) %>% 
  tab_footnote(
    footnote = md("*SE*: standard error of the ELPD"),
    locations = cells_column_labels(columns = vars("se_elpd_loo"))
  ) %>% 
  tab_footnote(
    footnote = md("*p*: effective number of parameters"),
    locations = cells_column_labels(columns = vars("p_loo"))
  ) %>% 
  tab_options(footnotes.marks = "letters")

```


We report the mean of each coefficient's posterior distribution along with standard errors and 95% CrI in Table 3. For interpretability, we report de derivative of the logistic function^[The derivative is calculated as $\hat{\beta_j}/4$, where $\hat{\beta_j}$ is the estimated mean of the posterior distribution of coefficient $j$. This value corresponds to the slope of the logistic curve at the midpoint, where it is steepest.] for each coefficient, which indicates the maximum difference in probability corresponding to one unit different in the input variable [@gelman_regression_2020].

```{r coefs, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

estimates <- bind_cols(
  "Comprehension" =  rename_all(as.data.frame(inv_logit_scaled(fixef(comp_7))), ~paste0(., "_comp")),
  "Production" =  rename_all(as.data.frame(inv_logit_scaled(fixef(prod_7))), ~paste0(., "_prod"))
) %>% 
  mutate(
    coefficient = c(
      "Intercept",
      "Age",
      "Frequency",
      "Dominance",
      "Bilingualism",
      "Cognate",
      "Dominance * Bilingualism",
      "Dominance * Cognate",
      "Bilingualism * Cognate",
      "Dominance * Bilingualism * Cognate"
    )
  ) %>% 
  clean_names() %>% 
  relocate(coefficient)

rownames(estimates) <- NULL

gt(estimates) %>% 
  tab_spanner(label = md("**Comprehension**"), columns = matches("_comp")) %>% 
  tab_spanner(label = md("**Production**"), columns = matches("_prod")) %>% 
  fmt_number(2:9) %>% 
  cols_merge_range(col_begin = "q2_5_comp", col_end = "q97_5_comp") %>% 
  cols_merge_range(col_begin = "q2_5_prod", col_end = "q97_5_prod") %>% 
  cols_label(
    coefficient = md("**Coefficient**"),
    estimate_comp = md("*Mean*"),
    est_error_comp = md("*SE*"),
    q2_5_comp = md("*95% CrI*"),
    estimate_prod = md("*Mean*"),
    est_error_prod = md("*SE*"),
    q2_5_prod = md("*95% CrI*"),
  ) %>% 
  tab_footnote(
    footnote = "SE: Standard Error of the mean",
    locations = cells_column_labels(columns = matches("est_error"))
  ) %>% 
  tab_footnote(
    footnote = "95% CrI: 95% credible interval",
    locations = cells_column_labels(columns = matches("q2_5"))
  )

```


The intercept (`r printnum(inv_logit_scaled(coef_comp["Intercept", "Estimate"])*100)`%) indicates probability of participants understanding TEs at mean age (`r printnum(mean(responses$age_scaled))` months), mean frequency (`r printnum(mean(responses$frequency_scaled))` Zipf score), and mean L2 exposure (`r printnum(mean(responses$bilingualism_scaled))`%), across the levels of the `dominance` and `cognate` factors. An increase in one standard deviation increment in age (1 *SD* = `r printnum(sd(responses$age_scaled))` months) is associated with a `r printnum(coef_comp["age", "Estimate"]*100/4)`% increment in comprehension probability. A one standard deviation increase in lexical frequency (1 *SD* = `r printnum(sd(responses$frequency_scaled))` Zipf scores) is associated with a `r printnum(coef_comp["frequency", "Estimate"]*100/4)`% increment in comprehension probability. Items in the dominant language were `r printnum(coef_comp["dominance1", "Estimate"]*100/4)`% more likely to be understood than items in the non-dominant language. A one standard deviation increase in exposure to the non-dominant language (1 *SD* = `printnum(sd(responses$bilingualism_scaled))`%) is associated with a `r printnum(coef_comp["bilingualism", "Estimate"]*100/4)` increment in comprehension probability. Cognates were `r printnum(coef_comp["cognate1", "Estimate"]*100/4)`% more like to be understood than non-cognates. The 95% credible interval of the three-way interaction (`dominance:bilingualism:cognate`) excluded 0, indicating that that the cognate status of the items changed the effect of dominance differently depending on the amount of exposure to the second language. Figure 1 shows the estimated marginal mean posterior probability of comprehension and production across ages, and the different levels of `dominance`, `bilingualism`, and `cognate`.


Children exposed to their second language more than -1 SD away from the mean (`r printnum(mean(responses$bilingualism_scaled)-sd(responses$bilingualism_scaled))`%) were more likely to understand cognates than non-cognates in their non-dominance language ($M_{Cognate}-M_{Non-cognate}$ = `r printnum(deltas$delta[6]*100)`%, 95% CrI = [`r printnum(deltas$.lower[6]*100)`-`r printnum(deltas$.upper[6]*100)`]), but not in their dominant language ($M_{Cognate}-M_{Non-cognate}$ = `r printnum(deltas$delta[2]*100)`%, 95% CrI = [`r printnum(deltas$.lower[2]*100)`-`r printnum(deltas$.upper[2]*100)`]). This difference was smaller for participants with mean exposure to the non-dominant language (`r printnum(mean(responses$bilingualism_scaled))`%): in the non-dominant language cognates were slight more likely to be understood than non-cognates ($M_{Cognate}-M_{Non-cognate}$ = `r printnum(deltas$delta[12]*100)`%, 95% CrI = [`r printnum(deltas$.lower[12]*100)`-`r printnum(deltas$.upper[12]*100)`]), but not in the dominant language ($M_{Cognate}-M_{Non-cognate}$ = `r printnum(deltas$delta[8]*100)`%, 95% CrI = [`r printnum(deltas$.lower[8]*100)`-`r printnum(deltas$.upper[8]*100)`]). Finally this effect was negligible for participants exposed to their second language more than -1 SD away from the mean (`r printnum(mean(responses$bilingualism_scaled)+sd(responses$bilingualism_scaled))`%). Cognates and non-cognates were equally likely to be understood in both the non-dominant ($M_{Cognate}-M_{Non-cognate}$ = `r printnum(deltas$delta[18]*100)`%, 95% CrI = [`r printnum(deltas$.lower[18]*100)`-`r printnum(deltas$.upper[18]*100)`]), and the dominant language ($M_{Cognate}-M_{Non-cognate}$ = `r printnum(deltas$delta[14]*100)`%, 95% CrI = [`r printnum(deltas$.lower[14]*100)`-`r printnum(deltas$.upper[14]*100)`]).


The difference in probability of comprehension between the dominant and the non-dominant languages differed between cognates and non-cognates and different levels of exposure to the non-dominant language. For children exposed. For children exposed to their non-dominant language less than 1 SD from the mean, difference in probability between the dominant and the non-dominant language was smaller for cognates ($M_{Dominant}-M_{Non-dominant}$ = `r printnum(deltas$delta[4]*100)`%, 95% CrI = [`r printnum(deltas$.lower[4]*100)`-`r printnum(deltas$.upper[4]*100)`]) than for non-cognates ($M_{Dominant}-M_{Non-dominant}$ = `r printnum(deltas$delta[1]*100)`%, 95% CrI = [`r printnum(deltas$.lower[1]*100)`-`r printnum(deltas$.upper[1]*100)`]). For children with mean exposure to the non-dominant language, this effect was smaller: the difference between the comprehension probability of items in L1 and L2 was slightly smaller for cognates ($M_{Dominant}-M_{Non-dominant}$ = `r printnum(deltas$delta[10]*100)`%, 95% CrI = [`r printnum(deltas$.lower[10]*100)`-`r printnum(deltas$.upper[10]*100)`]) than for non-cognates ($M_{Dominant}-M_{Non-dominant}$ = `r printnum(deltas$delta[7]*100)`%, 95% CrI = [`r printnum(deltas$.lower[7]*100)`-`r printnum(deltas$.upper[7]*100)`]). Finally this effect was negligible for children exposed more than 1 SD than the mean to their non-dominant language: the difference in comprehension probability between items in the dominant and the non-dominant language was roughly similar for cognates ($M_{Dominant}-M_{Non-dominant}$ = `r printnum(deltas$delta[16]*100)`%, 95% CrI = [`r printnum(deltas$.lower[16]*100)`-`r printnum(deltas$.upper[16]*100)`]) and non-cognates ($M_{Dominant}-M_{Non-dominant}$ = `r printnum(deltas$delta[13]*100)`%, 95% CrI = [`r printnum(deltas$.lower[13]*100)`-`r printnum(deltas$.upper[13]*100)`]).





```{r marginalmeans, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.width=6.5, fig.height=6.5, out.width="20cm", fig.cap="Mean posterior probability and 95\\% CrI of responses, conditional to Dominance, Bilingualism, and Cognate."}

post_preds %>% 
  ggplot(aes(
    age, .value,
    colour = interaction(dominance, cognate, sep = " - "),
    fill = interaction(dominance, cognate, sep = " - ")
  )) +
  facet_wrap(type~bilingualism) +
  #geom_line(aes(group = interaction(item_dominance, cognate, doe, .draw)), size = 0.4) +
  stat_lineribbon(.width = 0.95, colour = NA, alpha = 0.5) +
  stat_summary(fun = "mean", geom = "line", size = 0.75) +
  #geom_point(data = filter(proportion, type=="Understands"), alpha = 0.5) +
  labs(x = "Age (months)", y = "P(Y|X)") +
  guides(colour = guide_legend(ncol = 2)) +
  scale_color_brewer(palette = "Dark2") +
  scale_fill_brewer(palette = "Dark2") +
  scale_y_continuous(limits = c(0, 1)) +
  theme_custom() +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    legend.direction = "horizontal"
  )

```


# Discussion


# References


\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>

\endgroup


```{r create_r-references, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

r_refs(file = "trajectories.bib")

```

